	<!-- INCLUDE header.html -->
	<div class="page-header">
		<h1>Tu perfil de usuario</h1>
	</div>

	<div class="row">
		<div class="col-md-3">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Navegación</h3>
				</div>
				<div class="list-group">
				  <a href="index.php?" class="list-group-item">Información general</a>
				  <a href="index.php?option=1" class="list-group-item">Información personal</a>
				  <a href="index.php?option=2" class="list-group-item">Planes de servicio</a>
				  <a href="index.php?option=3" class="list-group-item">Vehículos registrados</a>
				  <a href="index.php?option=4" class="list-group-item">Historial de pagos</a>
				</div>
			</div>
		</div>
		<div class="col-md-8">
			<!-- IF BUY_PLAN == true -->
			<div class="alert alert-info" role="alert">
				<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<strong>Información:</strong>
				Su plan de servicio ha sido procesado correctamente.
			</div>
			<!-- ENDIF -->
			<!-- IF REGISTER_VEHICLE == true-->
			<div class="alert alert-warning" role="alert">
				<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<strong>Información:</strong>
				Su cuenta no tiene ningún vehículo registrado.
			</div>
			<!-- ENDIF -->
			<!-- IF SIDE_CONTENT == "home" -->
			<div class="col-md-11">
				<h3 class="text-muted">Información General</h3><hr>
				<table class="table table-striped">
					<thead>
						<tr>
							<th>Información General</th>
							<th></th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>Número de socio</td>
							<td>{U_MEMBER_ID}</td>
						</tr>
						<tr> 
							<td>Nombre de usuario</td>
							<td>{U_USER}</td>
						</tr>
						<tr>
							<td>Planes de servicio activos</td>
							<td>{U_SERVICE_PLANS}</td>
						</tr>
						<tr>
							<td>Vehículos registrados</td>
							<td>{U_REGISTERED_VEHICLES}</td>
						</tr>
					</tbody>
				</table>
				<div class="well well-lg">
					Si necesita de algun tipo de asistencia en la carretera, favor de llamar al número 787-XXX-XXXX.
				</div>
			</div>
			<!-- ELSEIF SIDE_CONTENT == 1 -->
				<!-- IF SAVE_DATA_ERROR == true -->
				<div class="alert alert-danger" role="alert">
					<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<strong>Error:</strong>
					{SAVE_DATA_ERROR_MGS}
				</div>
				<!-- ENDIF -->
			<div class="col-md-11">
				<h3 class="text-muted">Información personal</h3><hr>
				<form class="form-horizontal" action="{FORM_ACTION}" method="{FORM_METHOD}">
					<div class="form-group">
						<label class="col-sm-3 control-label">Primer nombre:</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="first" value="{FIRST}">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">Segundo nombre:</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="middle" value="{MIDDLE}">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">Apellido paterno:</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="last" value="{LAST}">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">Apellido materno:</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="maiden" value="{MAIDEN}">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">Dirección Línea 1:</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="address1" value="{ADDRESS1}">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">Dirección Línea 2:</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="address2" value="{ADDRESS2}">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">Ciudad:</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="city" value="{CITY}">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">Estado:</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="state" value="{STATE}">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">Zip:</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="zip" value="{ZIP}">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">País:</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="country" value="{COUNTRY}">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">Teléfono:</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="phone" value="{PHONE}">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">Email: </label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="email" value="{EMAIL}">
						</div>
					</div>
					<div class="form-group">
						<div class="col-sm-offset-4 col-sm-4">
							<button type="button" class="btn btn-default" id="cancel_button">Cancelar</button>
							<button type="submit" class="btn btn-primary" name="action" value="save_user">Guardar</button>
						</div>
					</div>
				</form>
			</div>
			<!-- ELSEIF SIDE_CONTENT == 2 -->
			<div class="col-md-11">
				<h3 class="text-muted">Planes de servicio</h3><hr>
				<!-- BEGIN user_plans -->
					<table class="table table-striped">
						<thead>
							<th>Información del plan {user_plans.INDEX}</th>
							<th>
								<div class="dropdown">
									<button class="btn btn-default dropdown-toggle" type="button" id="dropDownMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
										Opciones
										<span class="caret"></span>
									</button>
									<ul class="dropdown-menu" aria-labelledby="dropDownMenu">
										<li><a class="addVehicleLink" href="#" data-id="{user_plans.SERVICE_ID}" data-toggle="modal" data-target="#addVehicleModal">Añadir vehículo</a></li>
									</ul>
								</div>
							</th>
						</thead>
						<tbody>
							<tr>
								<td>Plan de servicio</td>
								<td>{user_plans.PLAN_NAME}</td>
							</tr>
							<tr>
								<td>Occurencias utilizadas</td>
								<td>{user_plans.OCCUR_CURR} de {user_plans.OCCUR_MAX}</td>
							</tr>
							<tr>
								<td>Millas utilizadas</td>
								<td>{user_plans.MILE_CURR} de {user_plans.MILE_MAX}</td>
							</tr>
							<tr>
								<td>Vehículos registrados</td>
								<td>{user_plans.VEHICLE_CURR} de {user_plans.VEHICLE_MAX}</td>
							</tr>
							<tr>
								<td>Fecha de expiración</td>
								<td>{user_plans.PLAN_EXP}</td>
							</tr>
						</tbody>
					</table>
				<!-- END -->
			</div>
			<!-- Modal -->
			<div class="modal fade" id="addVehicleModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			  <div class="modal-dialog" role="document">
			    <div class="modal-content">
			      <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
			        <h4 class="modal-title" id="myModalLabel">Añadir vehículo a plan de servicio</h4>
			      </div>
			      <div class="modal-body">
					<form class="form-horizontal">
					  <input type="hidden" name="serviceId" id="serviceId" value=""/>
						<div class="form-group">
							<label class="col-sm-3 control-label" for="type">Tipo:</label>
							<div class="col-sm-6">
								<select class="form-control" id="type" disabled>
									<option value="motora" default>Motora</option>
									<option value="carro">carro</option>
									<option value="lancha">Motora</option>
									<option value="bote">Motora</option>
								</select>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label" for="model">Modelo:</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" id="model">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label" for="brand">Marca:</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" id="brand">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label" for="year">Año:</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" id="year">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label" for="plate">Tablilla:</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" id="plate">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label" for="serial">Serie:</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" id="serial">
							</div>
						</div>
					</form>
			      </div>
			      <div class="modal-footer">
			        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
			        <button type="button" class="btn btn-primary" id="add_vehicle">Añadir</button>
			      </div>
			    </div>
			  </div>
			</div>
			<!-- Status modal -->
			<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="ModalLabel">
			  <div class="modal-dialog" role="document">
				<div class="modal-content">
				  <div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<h4 class="modal-title" id="ModalLabel"></h4>
				  </div>
				  <div class="modal-body" id="ModalBody">
				  </div>
				  <div class="modal-footer">
					<button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button>
				  </div>
				</div>
			  </div>
			</div>
			<!-- ELSEIF SIDE_CONTENT == 3 -->
			<div class="col-md-11">
				<h3 class="text-muted">Vehículos registrados</h3><hr>
				<table class="table table-striped">
					<thead>
						<th>Tipo de vehículo</th>
						<th>Modelo</th>
						<th>Marca</th>
						<th>Año</th>
						<th>tablilla</th>
						<th>Número de serie</th>
						<th>Plan de servicio</th>
						<th></th>
					</thead>
					<tbody>
					<!-- BEGIN vehicle_list -->
						<tr>
							<td>{vehicle_list.TYPE}</td>
							<td>{vehicle_list.MODEL}</td>
							<td>{vehicle_list.BRAND}</td>
							<td>{vehicle_list.YEAR}</td>
							<td>{vehicle_list.PLATE}</td>
							<td>{vehicle_list.SERIAL}</td>
							<td>{vehicle_list.SERVICE_PLAN}</td>
							<td></td>
						</tr>
					<!-- END -->
					</tbody>
				</table>
			</div>
			<!-- ELSEIF SIDE_CONTENT == 4 -->
			<div class="col-md-11">
				<h3 class="text-muted">Historial de pagos</h3><hr>
				<table class="table table-striped">
					<thead>
						<tr>
							<th>Número de transacción</th>
							<th>Pago emitido</th>
							<th>Método de pago</th>
							<th>Fecha de expedición</th>
						</tr>
					</thead>
					
					<tbody>
					<!-- BEGIN payment_history -->
					<tr>
						<td>{payment_history.TX}</td>
						<td>{payment_history.AMT}</td>
						<td>{payment_history.METHOD}</td>
						<td>{payment_history.DATE}</td>
					</tr>
					<!-- END -->
					</tbody>
				</table>
			</div>
			<!-- ENDIF -->
		</div>
	</div>
	<script>
		$(document).on("click", ".addVehicleLink", function () {
			 var serviceId = $(this).data('id');
			 $(".modal-body #serviceId").val( serviceId );
		});
		$('#add_vehicle').click(function(){
			$.ajax({
				type: "POST",
				url: "add_vehicle.php",
				data: {'service_id': $('#serviceId').val(),
					'type': $('#type').val(),
					'model': $('#model').val(),
					'brand': $('#brand').val(),
					'year': $('#year').val(),
					'plate': $('#plate').val(),
					'serial': $('#serial').val()},
				success: function(data){
					if (data === "success")
					{
						$('#addVehicleModal').modal('hide');

						$('#modal').modal('show');
						$("#ModalLabel").html('<strong>Información</strong>');
						$("#ModalBody").html('¡El vehículo ha sido añadido exitosamente!');
					}
					else
					{
						$('#addVehicleModal').modal('hide');

						$('#modal').modal('show');
						$("#ModalLabel").html('<strong>Error</strong>');
						$("#ModalBody").html(data);
					}
				}
			})
		});
		$('#modal').on('hidden.bs.modal', function() { 
			location.reload();
			//window.location.href = 'index.php';
		});
		$('#cancel_button').click(function()
		{
			// When user clicks cancel button the page is reloaded and home content is displayed
			window.location.href = 'index.php';
		});
	</script>
	<!-- INCLUDE footer.html -->
